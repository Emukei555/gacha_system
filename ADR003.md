# ADR-003: アーキテクチャ（ファイル構造）

## ステータス
- [X] Accepted（採用済み）

## 日付
- 提案日: 2026-1-20
- 決定日: 2026-1-20

## コンテキスト
プロジェクトを作成しる際に、アーキテクチャ（ファイル構造）を決める必要がある。

## 検討した選択肢

### 選択肢1: [レイヤードアーキテクチャ]
- メリット: シンプルなタイプでありファイル管理はしやすい
- デメリット: ドメインが純粋なJavaファイルになりずらい、別の機能が一つのファイルに混同する
- トレードオフ: ファイルが散らばり、手間が増える可能性

### 選択肢2: [オニオンアーキテクチャ]
- メリット: ドメイン中心で依存関係をDDDの思想に添い易い
- デメリット: ファイル階層が増えるためプロジェクトによってはオーバーエンジニアリングの可能性
- トレードオフ: 今回はドメインを重視するため多少の管理しずらさは受け入れる

### 選択肢3: [クリーンアーキテクチャ]
- メリット: 特に有名なアーキテクチャでDDDの思想にも合っている
- デメリット: ファイル階層がオニオンアーキテクチャ寄りも複雑になりオーバーエンジニアリングの可能性（特にこのプロジェクトは小規模なのでリスク大）
- オニオンアーキテクチャと比べて複雑な為採用は見送り

## 決定したもの
**選択肢2: オニオンアーキテクチャを採用**

## 決定の理由
レイヤードアーキテクチャと比べて依存関係をドメイン中心にでき、クリーンアーキテクチャと比べて扱い易い為
レイヤードアーキテクチャはシンプルだが依存関係が散らばりDDDの思想に反するため不採用
クリーンアーキテクチャは今回のプロジェクトにはオーバーエンジニアリングの可能性が高い為不採用

## 影響範囲・副作用
- 影響を受けるクラス: プロジェクト全体
- 影響を受けるユースケース: 消費・加算・状態更新全般
- 副作用: ファイル階層が深くなるがモノリスで対応可能
- 将来的な拡張: オニオン + バーティカルスライスへの拡張

## 関連ADR
- ADR-001: Resultパターンの基盤採用
- ADR-003: 不変条件のDB制約併用

## 参考資料
